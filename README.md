# picea-glauca-plastid
:evergreen_tree: Annotate the plastid genome of white spruce (Picea glauca)

1. The assembled FASTA file was inputted into GeSeq:
https://chlorobox.mpimp-golm.mpg.de/geseq.html
https://academic.oup.com/nar/article/45/W1/W6/3806659

2. GeSeq Settings: see below or GeSeq_settings.png
	A. FASTA file(s) to annotate
		Picea_glauca_WS77111-chloroplast.fa
			PATH: /projects/spruceup/pglauca/WS77111/assemblies/chloroplast/assembly/Picea_glauca_WS77111-chloroplast.fa
		Circular
		Sequence source: Plastid
	B. Options
		None selected
	C. Annotation
		Annotate plastid IR
		BLAT protein search Identity: 25
		BLAT rRNA, tRNA, DNA search Identity: 85
		Third party tRNA annotators
			ARAGORN v1.2.38
				Genetic code: Bacterial/Plant Chloroplast
				Max intron length: 3000
				Options: none selected
			tRNAscan-SE v2.0
				Sequence source: Organellar tRNAs
				Search mode: Default
				Genetic code: Universal
				Cut-off score for reporting tRNAs
				Score and report output options: Disable pseudogene checking
	D. BLAT Reference Sequences:
		Picea abies (NC_021456.1)
		Picea asperata (NC_03237.1)
		Picea crassifolia (NC_028594.1)
		Picea glauca (NC_028594.1)
		Picea jezonensis (NC_029374.1)
		Picea morrisonicola (NC_016069.1)
		Picea sitchensis (NC_011152.3)

3. GeSeq generates an OGDRAW .png file and a GenBank .gb file.

4. The .gb file is converted to a .gff file using EMBOSS Seqret:
https://www.ebi.ac.uk/Tools/sfc/emboss_seqret/
	A. Step 1 - Enter your input sequence
		Upload a file.
	B. Step 2 - Select Parameters
		Input Format - Genbank Entry Format
		Output Format - GFF3 feature file with sequence in FASTA format after (first of the two options)
			*the FASTA format sequence after was removed from the gff file later manually to declutter.
		More options - default settings

5. Duplicates were removed. Most conflicts were due to the Picea morrisonicola and Picea asperata reference annotations. One of them annotated tRNAs with anti-codons, and the other did not, so they were treated as different annotations and placed in the GeSeq generated .gb file twice. Those without anti-codons were removed from the final file. 

6. ARAGORN and tRNAscan detected some tRNAs that GeSeq did not detect. However, those were not detected with high confidence and were removed from the final annotation as they were not present in PG29, Q903, or Norway spruce annotations, making them highly unlikely as most of them are highly conserved sequences. These specific tRNAs can be seen in the Venn Diagram picea-glauca-master/VennDiagram.pdf.
	*GeSeq files were regenerated with and without third party tRNA annotators to cross reference which annotations were valid:
		- with only ARAGORN, no tRNAscan
		- with only tRNAscan, no ARAGORN
		- without both  ARAGORN and tRNAscan
	*summarized in the aforementioned Venn Diagram
	*RNAweasel used to confirm that the tRNAs were not valid:
		http://megasun.bch.umontreal.ca/cgi-bin/RNAweasel/RNAweaselInterface.pl
		see RNAweasel-settings.png 
			all options selected, 11 Plant Plastid
		see RNAweasel-results.txt	
7. Four genes specifically needed to be manually annotated: rps12, petB, petD, rpl16. Rps12 is trans-spliced, while the other genes had initial short exons. 

8. GeSeq did not annotate some mRNAs as well as some exons, which were later manually annotated as well (see final annotation). In the final annotation, all 114 genes were conserved, including the 74 coding regions (CDS), 4 rRNAs, 36 tRNAs, and 15 introns (9 of them in coding regions, 6 in tRNAs).

9. The .gb file generated by GeSeq was later manually re-edited to match changes made in the .gff file. This newly edited .gb file was fed through OGDRAW:
https://chlorobox.mpimp-golm.mpg.de/OGDraw.html

10. OGDraw settings: see below or picea-glauca-master/OGDRAW_settings.png
	A. Mode: Standard
	B. GenBank file to draw map
		File: WS77111-chloroplast-GenBank.gb
		Circular
		Sequence source: Plastid
		Annotation: Tidy up annotation
	C. Gene features
		Select all (including introns)
	D. Inverted Repeat
		Auto, Draw IR only
	E. Map Options
		Draw GC content graph
		Show full legend
		Label intron-containing genes with *
	F. Output format
		Vector: PDF, PNG

11. OGDRAW generated files located in: picea-glauca-master/ogdraw-extra

12. GFF annotation validated using table2asn_GFF: https://www.ncbi.nlm.nih.gov/genbank/genomes_gff/
	$ ./linux64.table2asn_GFF -i ../WS77111-chloroplast.fa -f WS77111-chloroplast-final-full.gff -o WS77111-chloroplast-final-full.asn -Z WS77111-chloroplast-final-full.dr -locus-tag-prefix WS77111CP
